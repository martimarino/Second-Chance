Index: src/main/java/it/unipi/dii/largescale/secondchance/controller/MyOrderController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package main.java.it.unipi.dii.largescale.secondchance.controller;\r\n\r\nimport javafx.scene.Scene;\r\nimport javafx.scene.control.*;\r\nimport javafx.scene.image.ImageView;\r\nimport javafx.scene.layout.*;\r\nimport javafx.stage.Stage;\r\nimport main.java.it.unipi.dii.largescale.secondchance.connection.ConnectionMongoDB;\r\nimport main.java.it.unipi.dii.largescale.secondchance.entity.Review;\r\nimport main.java.it.unipi.dii.largescale.secondchance.entity.User;\r\nimport main.java.it.unipi.dii.largescale.secondchance.utils.Session;\r\nimport main.java.it.unipi.dii.largescale.secondchance.utils.Utility;\r\nimport org.bson.Document;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\n\r\npublic class MyOrderController{\r\n\r\n\r\n    private static final int MAX_LENGTH = 50;\r\n    public BorderPane ordersContainer;\r\n    public ComboBox<String> comboBox;\r\n    public Pane prev;\r\n    public Pane next;\r\n\r\n    public ArrayList<Document> ordersList;\r\n    public VBox panel;\r\n    User user;\r\n\r\n    int indexPage;\r\n    int k = 6; // number of orders show into current page\r\n    boolean kind;\r\n    String type_img;\r\n\r\n    public void initialize(){\r\n\r\n        type_img = \"insertion\";\r\n        //set buttons\r\n        prev.setDisable(true);\r\n        next.setDisable(true);\r\n        prev.setVisible(false);\r\n        next.setVisible(false);\r\n\r\n        k = 4;\r\n        indexPage = 1;\r\n\r\n        ordersList = new ArrayList<>();\r\n        panel = new VBox();\r\n        panel.getChildren().clear();\r\n        ordersContainer.setCenter(panel);\r\n\r\n    }\r\n\r\n    public void showOrders() {\r\n\r\n        String type = comboBox.getValue();\r\n\r\n        user = Session.getLoggedUser();\r\n\r\n        if (type.equals(\"Items purchased\")) {\r\n            if(ordersList != null && ordersList.size() != 0) {\r\n                panel.getChildren().clear();\r\n                indexPage = 1;\r\n            }\r\n            System.out.println(\"Purchased: \" + Session.getLoggedUser().getPurchased());\r\n            ordersList = Session.getLoggedUser().getPurchased();\r\n            kind = true;\r\n            showAllOrders(true);\r\n        }\r\n        else if(type.equals(\"Items sold\"))\r\n        {\r\n            if(ordersList != null && ordersList.size() != 0) {\r\n                panel.getChildren().clear();\r\n                indexPage = 1;\r\n            }\r\n            ordersList = Session.getLoggedUser().getSold();\r\n            kind = false;\r\n            showAllOrders(false);\r\n        }\r\n\r\n        if(ordersList != null && ordersList.size() > k)\r\n        {\r\n            next.setVisible(true);\r\n            next.setDisable(false);\r\n        }\r\n    }\r\n\r\n    private void showAllOrders(boolean choice) {\r\n\r\n        if(ordersList != null && ordersList.size() != 0) {\r\n            for (int i = 0; i < k && indexPage <= ordersList.size(); i++) {\r\n                addOrder(choice);\r\n                indexPage++;\r\n            }\r\n\r\n            if (ordersList.size() < indexPage) {\r\n                next.setDisable(true);\r\n                next.setVisible(false);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private void addOrder(boolean choice) {\r\n\r\n        HBox hbox;\r\n        VBox vbox;\r\n        Button review = new Button();\r\n        Document ins = (Document) ordersList.get(indexPage-1).get(\"insertion\");\r\n\r\n        String sel = ordersList.get(indexPage-1).getString(\"seller\");\r\n        String orderTimestamp = ordersList.get(indexPage-1).getString(\"timestamp\");\r\n        Label buyer = new Label(\"Buyer: \" + ordersList.get(indexPage-1).getString(\"buyer\"));\r\n        Label timestamp = new Label(\"Date Order: \" + ordersList.get(indexPage-1).getString(\"timestamp\"));\r\n        Label seller = new Label(\"Seller: \" + sel);\r\n        Label price = new Label(\"Price: \" + ins.getDouble(\"price\"));\r\n        Label size = new Label(\"Size: \" + ins.getString(\"size\"));\r\n        Label status = new Label(\"Status: \" + ins.getString(\"status\"));\r\n        Label category = new Label(\"Category: \" + ins.getString(\"category\"));\r\n        ImageView image = Utility.getGoodImage(ins.getString(\"image\"), 110, type_img);\r\n\r\n        if(ordersList.get(indexPage-1).getBoolean(\"reviewed\") && choice) {\r\n            review.setText(\"Already reviewed!\");\r\n            review.setDisable(true);\r\n        }\r\n        else\r\n            review.setText(\"Review now!\");\r\n\r\n        if(choice) {\r\n            vbox = new VBox(seller, timestamp, price, category, size, status);\r\n            hbox = new HBox(image, vbox, review);\r\n        }\r\n        else {\r\n            vbox = new VBox(buyer, timestamp, price, category, size, status);\r\n            hbox = new HBox(image, vbox);\r\n        }\r\n\r\n        panel.setSpacing(12);\r\n        hbox.setSpacing(40);\r\n        hbox.setStyle(\"-fx-padding: 15px; -fx-background-color: white; ; -fx-background-radius: 20px;\");\r\n        vbox.setStyle(\"-fx-padding: 5px; -fx-font-size: 14px\");\r\n\r\n        panel.getChildren().add(hbox);\r\n\r\n        review.setOnMouseClicked(event-> addReview(sel, orderTimestamp, review)\r\n        );\r\n    }\r\n\r\n    public void PrevOrder() {\r\n\r\n        panel.getChildren().clear();\r\n        int ind = (indexPage%(k+1)) == 0? 1 : (indexPage%(k+1));\r\n        indexPage-= (k + ind);\r\n\r\n        next.setDisable(false);\r\n        next.setVisible(true);\r\n\r\n        if(indexPage < k)\r\n        {\r\n            prev.setDisable(true);\r\n            prev.setVisible(false);\r\n        }\r\n\r\n        showAllOrders(kind);\r\n\r\n    }\r\n\r\n    public void NextOrder() {\r\n\r\n        panel.getChildren().clear();\r\n\r\n        showAllOrders(kind);\r\n\r\n        prev.setDisable(false);\r\n        prev.setVisible(true);\r\n    }\r\n\r\n    private void addReview(String seller, String timestampOrder, Button revButton) {        //panel builder\r\n\r\n        StackPane secondaryLayout = new StackPane();\r\n        TextArea txtArea = new TextArea();\r\n        TextField txtTitle = new TextField();\r\n        ComboBox<String> rating = new ComboBox();\r\n\r\n        rating.getSelectionModel().select(\"rating\");\r\n        rating.getItems().add(\"1\");\r\n        rating.getItems().add(\"2\");\r\n        rating.getItems().add(\"3\");\r\n        rating.getItems().add(\"4\");\r\n        rating.getItems().add(\"5\");\r\n\r\n        txtArea.setPrefHeight(150);\r\n        txtArea.setPrefWidth(250);\r\n\r\n        txtTitle.setPrefHeight(10);\r\n        txtTitle.setPrefWidth(100);\r\n\r\n        Button sendReview = new Button();\r\n        sendReview.setText(\"Send review\");\r\n        sendReview.setStyle(\"-fx-border-width: 50\");\r\n\r\n        txtTitle.setPromptText(\"Title review\");\r\n        txtArea.setPromptText(\"Max 150 characters\");\r\n\r\n        HBox hbox = new HBox(txtTitle, rating);\r\n        VBox vbox = new VBox(hbox, txtArea, sendReview);\r\n        hbox.setSpacing(10);\r\n        vbox.setSpacing(10);\r\n\r\n        secondaryLayout.getChildren().add(vbox);\r\n        Scene secondScene = new Scene(secondaryLayout, 400, 200);\r\n\r\n        // New window\r\n        Stage newWindow = new Stage();\r\n        newWindow.setTitle(\"Review user\");\r\n        newWindow.setScene(secondScene);\r\n        newWindow.show();\r\n\r\n        sendReview.setOnMouseClicked(event-> {\r\n\r\n            if (txtArea.getText().trim().equals(\"\") || txtTitle.getText().trim().isEmpty() || rating.getValue().equals(\"rating\")) {\r\n                Utility.infoBox(\"Insert all the data\", \"User Alert\", \"Empty fields\");\r\n                return;\r\n            }\r\n\r\n            if(txtArea.getText().length() > MAX_LENGTH)\r\n            {\r\n                Utility.infoBox(\"Review with too many characters\", \"User Alert\", \"Incorrect field\");\r\n                return;\r\n            }\r\n\r\n            sendReview(txtArea, txtTitle, sendReview, revButton, Integer.parseInt(rating.getValue()), seller, timestampOrder);\r\n        });\r\n\r\n    }\r\n\r\n    public void sendReview(TextArea txtArea, TextField txtTitle, Button sendReview, Button revButton, int rating, String seller, String timestampOrder){\r\n\r\n        SimpleDateFormat date = new SimpleDateFormat(\"dd-MM-yy HH:mm:ss\");\r\n        String timestamp = date.format(new Date());\r\n        System.out.println(\"timestamp: \" + timestamp);\r\n\r\n        Review rev = new Review( user.getUsername(), seller, txtArea.getText(), timestamp, txtTitle.getText(), rating);\r\n        Utility.printTerminal(\"REV: \" + rev);\r\n\r\n        ConnectionMongoDB.connMongo.addReview(rev);\r\n        ConnectionMongoDB.connMongo.updateSellerRating(rev.getSeller());\r\n        Document updated = setIsertionReviewed(timestampOrder);     //update local array\r\n        ConnectionMongoDB.connMongo.setInsertionReviewed(timestampOrder, updated);  //update remote array\r\n        sendReview.setDisable(true);\r\n        revButton.setText(\"Already reviewed!\");\r\n        revButton.setDisable(true);\r\n\r\n        Stage stage = (Stage) sendReview.getScene().getWindow();\r\n        stage.close();\r\n    }\r\n\r\n    private Document setIsertionReviewed(String ts) {\r\n\r\n        ArrayList<Document> purc = Session.getLoggedUser().getPurchased();\r\n\r\n        Document n = null;\r\n        for(Document d : purc)\r\n            if(d.getString(\"timestamp\").equals(ts)) {\r\n                d.replace(\"reviewed\", true);\r\n                n = d;\r\n            }\r\n\r\n        return n;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/it/unipi/dii/largescale/secondchance/controller/MyOrderController.java b/src/main/java/it/unipi/dii/largescale/secondchance/controller/MyOrderController.java
--- a/src/main/java/it/unipi/dii/largescale/secondchance/controller/MyOrderController.java	(revision 190fd7128d92f590f9f2fdee59ddb2931f30cfd5)
+++ b/src/main/java/it/unipi/dii/largescale/secondchance/controller/MyOrderController.java	(date 1644573975291)
@@ -18,7 +18,7 @@
 public class MyOrderController{
 
 
-    private static final int MAX_LENGTH = 50;
+    private static final int MAX_LENGTH = 150;
     public BorderPane ordersContainer;
     public ComboBox<String> comboBox;
     public Pane prev;
@@ -139,7 +139,7 @@
         panel.setSpacing(12);
         hbox.setSpacing(40);
         hbox.setStyle("-fx-padding: 15px; -fx-background-color: white; ; -fx-background-radius: 20px;");
-        vbox.setStyle("-fx-padding: 5px; -fx-font-size: 14px");
+        vbox.setStyle("-fx-font-size: 14px");
 
         panel.getChildren().add(hbox);
 
